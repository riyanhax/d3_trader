var app = require('express')();
var server = require('http').createServer(app);
var io = require('socket.io')(server);
server.listen(3080);

var jsonData = {
      '2017-09-06': [62.40, 63.34, 61.79, 62.88, 30],
      '2017-09-07': [63.37, 63.48, 62.15, 62.50, 33],
      '2017-09-08': [63.66, 64.36, 62.82, 63.19, 33],
      '2017-09-09': [62.45, 63.59, 62.07, 63.34, 33],
      '2017-09-10': [62.62, 63.42, 62.32, 62.87, 34],
      '2017-09-11': [63.23, 63.59, 62.05, 63.08, 34],
      '2017-09-12': [63.95, 64.17, 62.56, 63.30, 35],
      '2017-09-13': [63.84, 64.30, 63.51, 63.83, 36],
      '2017-09-14': [63.39, 64.14, 62.62, 63.51, 36],
      '2017-09-15': [61.62, 63.51, 61.57, 63.48, 36],
      '2017-09-16': [60.41, 61.45, 60.15, 61.35, 36],
      '2017-09-17': [60.94, 61.48, 60.40, 60.52, 36],
      '2017-09-18': [58.56, 60.50, 58.25, 60.49, 36],
      '2017-09-19': [59.50, 60.19, 58.18, 58.56, 37],
      '2017-09-20': [57.89, 59.56, 57.57, 59.21, 37],
      '2017-09-21': [58.31, 58.45, 57.31, 58.02, 37],
      '2017-09-22': [59.26, 59.38, 57.52, 57.92, 34],
      '2017-09-23': [59.53, 60.45, 58.95, 59.23, 34],
      '2017-09-24': [59.66, 60.89, 59.51, 59.83, 33],
      '2017-09-25': [57.98, 59.90, 57.98, 59.83, 37],
      '2017-09-26': [56.85, 57.65, 56.38, 57.24, 37],
      '2017-09-27': [57.23, 58.82, 56.50, 56.76, 38],
      '2017-09-28': [58.77, 59.30, 56.26, 57.39, 38],
      '2017-09-29': [60.98, 61.15, 58.49, 58.53, 38],
      '2017-09-30': [59.67, 61.35, 59.18, 61.22, 38],
      '2017-10-01': [60.43, 62.28, 60.21, 61.15, 41],
      '2017-10-02': [57.58, 59.85, 57.16, 59.78, 41.3],
      '2017-10-03': [56.09, 58.28, 55.84, 58.15, 41.6],
      '2017-10-04': [58.05, 58.31, 54.66, 56.14, 42.3]
    }

io.on('connect', function (socket) {
  function countTimer() {
    socket.emit('jsonData', {
      topic: 'jsonData',
      payload: jsonData
    })
  }

  const countInterval = setInterval(() => {
    countTimer()
  }, 10000)

  socket.on('fu', function(data) {
    console.log(data)
  })

  socket.on('disconnect', function () {
    clearInterval(countInterval)
  });
});